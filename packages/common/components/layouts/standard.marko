import { get, getAsArray } from "@mindful-web/object-path";
import { stripHtml } from "@mindful-web/html";
import queryFragment from "@pmmi-media-group/package-common/graphql/fragments/content-list";

$ const { website, config } = out.global;
$ const { newsletter, date } = input.data;

$ const newsletterConfig = config.get(newsletter.alias);
$ const newsletterName = get(newsletterConfig, "name");
$ const newsletterDescription = stripHtml(get(newsletterConfig, "description"));
$ const brandName = get(newsletterConfig, "brandName");
$ let title = `${brandName} | ${newsletterName}`;
$ if (`${newsletterName}` === 'Insights') {
  title = `${brandName} ${newsletterName}`;
};
$ const emailX = config.get('emailX');
$ const sections = input.sections || [];

<marko-newsletter-root
  title=title
  description=newsletterDescription
  date=date
>
  <@head>
    <common-head-block title=title style-component=input.styleComponent style-component-input=input.styleComponentInput />
  </@head>
  <@body class="email-bg" style="margin: 0 !important; padding: 0 !important;background-color: #edeeee;">
    <common-body-wrapper-block newsletter=newsletter date=date header=input.header footer=input.footer>

      <@body>
        <html-comment> Audience Banner </html-comment>
        <common-ad-nativex-block
          newsletter=newsletter
          date=date
          placement="top-audience-banner"
        />
        <html-comment> /Audience Banner </html-comment>

        <html-comment> Main Feature </html-comment>
        <if(sections.includes("Feature"))>
          <common-standard-feature-content-block
            newsletter=newsletter
            date=date
            section-name="Feature"
          />
        </if>
        <html-comment> End Main Feature </html-comment>


        <html-comment> Advetiser Logo </html-comment>
        <html-comment> /Advetiser Logo </html-comment>

        <html-comment> Articles </html-comment>
        <table border="0" cellpadding="0" cellspacing="0" width="100%">
          <tr>
            <td bgcolor="#ffffff" style="background-color: #ffffff" align="center" class="mobile-padding">
              <table class="content-table" align="center" border="0" cellpadding="0" cellspacing="0" style="width: 600px;">
              <html-comment> ⊙▃⊙ </html-comment>
              <html-comment> ........ </html-comment>
              <html-comment> ................ </html-comment>
              <html-comment> ................................ </html-comment>
              <html-comment> AD 1 begin </html-comment>
              <html-comment> AD 1 end </html-comment>
              <html-comment> ................................ </html-comment>
              <html-comment> ................ </html-comment>
              <html-comment> ........ </html-comment>
              <html-comment> ๏_๏ </html-comment>

              <html-comment> ⊙▃⊙ </html-comment>
              <html-comment> ........ </html-comment>
              <html-comment> ................ </html-comment>
              <html-comment> ................................ </html-comment>
              <html-comment> AD 2 begin </html-comment>
              <html-comment> AD 2 end </html-comment>
              <html-comment> ................................ </html-comment>
              <html-comment> ................ </html-comment>
              <html-comment> ........ </html-comment>
              <html-comment> ๏_๏ </html-comment>

              <if(sections.includes("Standard"))>
                <common-standard-content-list-block
                  newsletter=newsletter
                  date=date
                  section-name="Standard"
                  limit=2
                  skip=0
                />
              </if>

              <html-comment> ⊙▃⊙ </html-comment>
              <html-comment> ........ </html-comment>
              <html-comment> ................ </html-comment>
              <html-comment> ................................ </html-comment>
              <html-comment> AD 3 begin </html-comment>
              <html-comment> AD 3 end </html-comment>
              <html-comment> ................................ </html-comment>
              <html-comment> ................ </html-comment>
              <html-comment> ........ </html-comment>
              <html-comment> ๏_๏ </html-comment>

              <html-comment> ⊙▃⊙ </html-comment>
              <html-comment> ........ </html-comment>
              <html-comment> ................ </html-comment>
              <html-comment> ................................ </html-comment>
              <html-comment> AD 4 begin </html-comment>
              <html-comment> AD 4 end </html-comment>
              <html-comment> ................................ </html-comment>
              <html-comment> ................ </html-comment>
              <html-comment> ........ </html-comment>
              <html-comment> ๏_๏ </html-comment>

              <if(sections.includes("Standard"))>
                <common-standard-content-list-block
                  newsletter=newsletter
                  date=date
                  section-name="Standard"
                  limit=2
                  skip=2
                />
              </if>

              <html-comment> ⊙▃⊙ </html-comment>
              <html-comment> ........ </html-comment>
              <html-comment> ................ </html-comment>
              <html-comment> ................................ </html-comment>
              <html-comment> AD 5 begin </html-comment>
              <html-comment> AD 5 end </html-comment>
              <html-comment> ................................ </html-comment>
              <html-comment> ................ </html-comment>
              <html-comment> ........ </html-comment>
              <html-comment> ๏_๏ </html-comment>

              <if(sections.includes("Standard"))>
                <common-standard-content-list-block
                  newsletter=newsletter
                  date=date
                  section-name="Standard"
                  limit=1
                  skip=4
                />
              </if>


              </table>
            </td>
          </tr>
        </table>
        <html-comment> /Article </html-comment>

        <if(sections.includes("Products"))>
          <!-- Products -->
          <common-standard-product-list-block
            newsletter=newsletter
            date=date
            section-name="Products"
            limit=4
          />
        </if>

        <if(sections.includes("Editor's Picks"))>
          <!-- Editor's Picks -->
          <common-standard-content-list-block
            newsletter=newsletter
            date=date
            section-name="Editor's Picks"
            section-description="News and new products for your healthcare packaging needs"
            limit=4
            with-header=true
          />
        </if>

        <html-comment> ⊙▃⊙ </html-comment>
        <html-comment> ........ </html-comment>
        <html-comment> ................ </html-comment>
        <html-comment> ................................ </html-comment>
        <html-comment> Syndicated Content Block Goes Here - AW Automation Skills, AW News Insights, AW Product Insights </html-comment>
        <html-comment> End Syndicated Content </html-comment>
        <html-comment> ................................ </html-comment>
        <html-comment> ................ </html-comment>
        <html-comment> ........ </html-comment>
        <html-comment> ๏_๏ </html-comment>

        <if(sections.includes("What's Trending"))>
          <!-- What's Trending -->
          <common-standard-trending-list-block
            newsletter=newsletter
            date=date
            section-name="What's Trending"
            limit=2
          />
        </if>

        <html-comment> PE Announcement </html-comment>
        <common-ad-emailx-block
          newsletter=newsletter
          ad-unit=emailX.getAdUnit({ name: "bottom-audience-banner", alias: newsletter.alias })
          date=date
        />
        <html-comment> /PE Announcement </html-comment>

      </@body>
    </common-body-wrapper-block>
  </@body>
</marko-newsletter-root>
